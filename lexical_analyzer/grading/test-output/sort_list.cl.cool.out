CLASS
OBJECTID List
INHERITS
OBJECTID IO
'{'
TYPEID isNil
'('
')'
':'
OBJECTID Bool
'{'
'{'
TYPEID abort
'('
')'
';'
BOOL_CONST true
';'
'}'
'}'
';'
TYPEID cons
'('
TYPEID hd
':'
OBJECTID Int
')'
':'
OBJECTID Cons
'{'
'('
LET
TYPEID new_cell
':'
OBJECTID Cons
ASSIGN
NEW
OBJECTID Cons
IN
TYPEID new_cell
'.'
TYPEID init
'('
TYPEID hd
','
TYPEID self
')'
')'
'}'
';'
TYPEID car
'('
')'
':'
OBJECTID Int
'{'
'{'
TYPEID abort
'('
')'
';'
NEW
OBJECTID Int
';'
'}'
'}'
';'
TYPEID cdr
'('
')'
':'
OBJECTID List
'{'
'{'
TYPEID abort
'('
')'
';'
NEW
OBJECTID List
';'
'}'
'}'
';'
TYPEID rev
'('
')'
':'
OBJECTID List
'{'
TYPEID cdr
'('
')'
'}'
';'
TYPEID sort
'('
')'
':'
OBJECTID List
'{'
TYPEID cdr
'('
')'
'}'
';'
TYPEID insert
'('
TYPEID i
':'
OBJECTID Int
')'
':'
OBJECTID List
'{'
TYPEID cdr
'('
')'
'}'
';'
TYPEID rcons
'('
TYPEID i
':'
OBJECTID Int
')'
':'
OBJECTID List
'{'
TYPEID cdr
'('
')'
'}'
';'
TYPEID print_list
'('
')'
':'
OBJECTID Object
'{'
TYPEID abort
'('
')'
'}'
';'
'}'
';'
CLASS
OBJECTID Cons
INHERITS
OBJECTID List
'{'
TYPEID xcar
':'
OBJECTID Int
';'
TYPEID xcdr
':'
OBJECTID List
';'
TYPEID isNil
'('
')'
':'
OBJECTID Bool
'{'
BOOL_CONST false
'}'
';'
TYPEID init
'('
TYPEID hd
':'
OBJECTID Int
','
TYPEID tl
':'
OBJECTID List
')'
':'
OBJECTID Cons
'{'
'{'
TYPEID xcar
ASSIGN
TYPEID hd
';'
TYPEID xcdr
ASSIGN
TYPEID tl
';'
TYPEID self
';'
'}'
'}'
';'
TYPEID car
'('
')'
':'
OBJECTID Int
'{'
TYPEID xcar
'}'
';'
TYPEID cdr
'('
')'
':'
OBJECTID List
'{'
TYPEID xcdr
'}'
';'
TYPEID rev
'('
')'
':'
OBJECTID List
'{'
'('
TYPEID xcdr
'.'
TYPEID rev
'('
')'
')'
'.'
TYPEID rcons
'('
TYPEID xcar
')'
'}'
';'
TYPEID sort
'('
')'
':'
OBJECTID List
'{'
'('
TYPEID xcdr
'.'
TYPEID sort
'('
')'
')'
'.'
TYPEID insert
'('
TYPEID xcar
')'
'}'
';'
TYPEID insert
'('
TYPEID i
':'
OBJECTID Int
')'
':'
OBJECTID List
'{'
IF
TYPEID i
'<'
TYPEID xcar
THEN
'('
NEW
OBJECTID Cons
')'
'.'
TYPEID init
'('
TYPEID i
','
TYPEID self
')'
ELSE
'('
NEW
OBJECTID Cons
')'
'.'
TYPEID init
'('
TYPEID xcar
','
TYPEID xcdr
'.'
TYPEID insert
'('
TYPEID i
')'
')'
FI
'}'
';'
TYPEID rcons
'('
TYPEID i
':'
OBJECTID Int
')'
':'
OBJECTID List
'{'
'('
NEW
OBJECTID Cons
')'
'.'
TYPEID init
'('
TYPEID xcar
','
TYPEID xcdr
'.'
TYPEID rcons
'('
TYPEID i
')'
')'
'}'
';'
TYPEID print_list
'('
')'
':'
OBJECTID Object
'{'
'{'
TYPEID out_int
'('
TYPEID xcar
')'
';'
TYPEID out_string
'('
STR_CONST "\\n"
')'
';'
TYPEID xcdr
'.'
TYPEID print_list
'('
')'
';'
'}'
'}'
';'
'}'
';'
CLASS
OBJECTID Nil
INHERITS
OBJECTID List
'{'
TYPEID isNil
'('
')'
':'
OBJECTID Bool
'{'
BOOL_CONST true
'}'
';'
TYPEID rev
'('
')'
':'
OBJECTID List
'{'
TYPEID self
'}'
';'
TYPEID sort
'('
')'
':'
OBJECTID List
'{'
TYPEID self
'}'
';'
TYPEID insert
'('
TYPEID i
':'
OBJECTID Int
')'
':'
OBJECTID List
'{'
TYPEID rcons
'('
TYPEID i
')'
'}'
';'
TYPEID rcons
'('
TYPEID i
':'
OBJECTID Int
')'
':'
OBJECTID List
'{'
'('
NEW
OBJECTID Cons
')'
'.'
TYPEID init
'('
TYPEID i
','
TYPEID self
')'
'}'
';'
TYPEID print_list
'('
')'
':'
OBJECTID Object
'{'
BOOL_CONST true
'}'
';'
'}'
';'
CLASS
OBJECTID Main
INHERITS
OBJECTID IO
'{'
TYPEID l
':'
OBJECTID List
';'
TYPEID iota
'('
TYPEID i
':'
OBJECTID Int
')'
':'
OBJECTID List
'{'
'{'
TYPEID l
ASSIGN
NEW
OBJECTID Nil
';'
'('
LET
TYPEID j
':'
OBJECTID Int
ASSIGN
INT_CONST 0
IN
WHILE
TYPEID j
'<'
TYPEID i
LOOP
'{'
TYPEID l
ASSIGN
'('
NEW
OBJECTID Cons
')'
'.'
TYPEID init
'('
TYPEID j
','
TYPEID l
')'
';'
TYPEID j
ASSIGN
TYPEID j
'+'
INT_CONST 1
';'
'}'
POOL
')'
';'
TYPEID l
';'
'}'
'}'
';'
TYPEID main
'('
')'
':'
OBJECTID Object
'{'
'{'
TYPEID out_string
'('
STR_CONST "How many numbers to sort?"
')'
';'
TYPEID iota
'('
TYPEID in_int
'('
')'
')'
'.'
TYPEID rev
'('
')'
'.'
TYPEID sort
'('
')'
'.'
TYPEID print_list
'('
')'
';'
'}'
'}'
';'
'}'
';'
