CLASS
OBJECTID Main
INHERITS
OBJECTID IO
'{'
TYPEID main
'('
')'
':'
OBJECTID SELF_TYPE
'{'
'('
LET
TYPEID c
':'
OBJECTID Complex
ASSIGN
'('
NEW
OBJECTID Complex
')'
'.'
TYPEID init
'('
INT_CONST 1
','
INT_CONST 1
')'
IN
'{'
IF
TYPEID c
'.'
TYPEID reflect_X
'('
')'
'='
TYPEID c
'.'
TYPEID reflect_0
'('
')'
THEN
TYPEID out_string
'('
STR_CONST "=)\\n"
')'
ELSE
TYPEID out_string
'('
STR_CONST "=(\\n"
')'
FI
';'
IF
TYPEID c
'.'
TYPEID reflect_X
'('
')'
'.'
TYPEID reflect_Y
'('
')'
'.'
TYPEID equal
'('
TYPEID c
'.'
TYPEID reflect_0
'('
')'
')'
THEN
TYPEID out_string
'('
STR_CONST "=)\\n"
')'
ELSE
TYPEID out_string
'('
STR_CONST "=(\\n"
')'
FI
';'
'}'
')'
'}'
';'
'}'
';'
CLASS
OBJECTID Complex
INHERITS
OBJECTID IO
'{'
TYPEID x
':'
OBJECTID Int
';'
TYPEID y
':'
OBJECTID Int
';'
TYPEID init
'('
TYPEID a
':'
OBJECTID Int
','
TYPEID b
':'
OBJECTID Int
')'
':'
OBJECTID Complex
'{'
'{'
TYPEID x
'='
TYPEID a
';'
TYPEID y
'='
TYPEID b
';'
TYPEID self
';'
'}'
'}'
';'
TYPEID print
'('
')'
':'
OBJECTID Object
'{'
IF
TYPEID y
'='
INT_CONST 0
THEN
TYPEID out_int
'('
TYPEID x
')'
ELSE
TYPEID out_int
'('
TYPEID x
')'
'.'
TYPEID out_string
'('
STR_CONST "+"
')'
'.'
TYPEID out_int
'('
TYPEID y
')'
'.'
TYPEID out_string
'('
STR_CONST "I"
')'
FI
'}'
';'
TYPEID reflect_0
'('
')'
':'
OBJECTID Complex
'{'
'{'
TYPEID x
'='
'~'
TYPEID x
';'
TYPEID y
'='
'~'
TYPEID y
';'
TYPEID self
';'
'}'
'}'
';'
TYPEID reflect_X
'('
')'
':'
OBJECTID Complex
'{'
'{'
TYPEID y
'='
'~'
TYPEID y
';'
TYPEID self
';'
'}'
'}'
';'
TYPEID reflect_Y
'('
')'
':'
OBJECTID Complex
'{'
'{'
TYPEID x
'='
'~'
TYPEID x
';'
TYPEID self
';'
'}'
'}'
';'
TYPEID equal
'('
TYPEID d
':'
OBJECTID Complex
')'
':'
OBJECTID Bool
'{'
IF
TYPEID x
'='
TYPEID d
'.'
TYPEID x_value
'('
')'
THEN
IF
TYPEID y
'='
TYPEID d
'.'
TYPEID y_value
'('
')'
THEN
BOOL_CONST true
ELSE
BOOL_CONST false
FI
ELSE
BOOL_CONST false
FI
'}'
';'
TYPEID x_value
'('
')'
':'
OBJECTID Int
'{'
TYPEID x
'}'
';'
TYPEID y_value
'('
')'
':'
OBJECTID Int
'{'
TYPEID y
'}'
';'
'}'
';'
